sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/base/EventProvider"],function(a,b,c){"use strict";var d=c.extend("nrg.base.component.WebUiManager",{constructor:function(a){c.apply(this),this._oComponent=a},metadata:{publicMethods:["start","notifyWebUi","cancelWebUiEvent","isAvailable"]}});return d.prototype.start=function(){this._addDomEventListener()},d.prototype.isAvailable=function(){var a=!0;return window.parent===window?!1:a},d.prototype.cancelWebUiEvent=function(a,b,c,d){var e=[a,b].join("-");return this.detachEvent(e,c,d),this.notifyWebUi("cancelEvent",{EVENT:a,SID:b}),this},d.prototype.notifyWebUi=function(b,c,d,e){var f,g,h;return this.isAvailable()?b?(g={},g.EVENT=b,c&&(g.PAYLOAD=c),d&&(h=this._getUniqueId(),g.SID=h,this.attachEventOnce([g.EVENT,g.SID].join("-"),d,e)),f=JSON.stringify(g),a.sap.log.info("[WebUiManager.notifyWebUi()]",f),window.parent.postMessage(f,this._getDomain()),h||this):(a.sap.log.error("[WebUiManager.notifyWebUi()]","Event name is not provided"),this):(a.sap.log.error("[WebUiManager.notifyWebUi()]","Unable to post message because this component is not embedded in any parent window"),this)},d.prototype._fromWebUi=function(b){var c;b.origin===this._getDomain()&&(c=JSON.parse(b.data),c&&c.EVENT&&(a.sap.log.info("[WebUiManager._fromWebUi()]",b.data),c.SID?this.fireEvent([c.EVENT,c.SID].join("-"),c.PAYLOAD):this.fireEvent(c.EVENT,c.PAYLOAD)))},d.prototype._getDomain=function(){return window.location.protocol+"//"+window.location.host},d.prototype._addDomEventListener=function(){window.addEventListener?window.addEventListener("message",a.proxy(this._fromWebUi,this),!1):window.attachEvent("onmessage",a.proxy(this._fromWebUi,this))},d.prototype._getUniqueId=function(){var a=+new Date;return a.toString()},d});