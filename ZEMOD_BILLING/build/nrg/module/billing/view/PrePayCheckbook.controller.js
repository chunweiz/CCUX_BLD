sap.ui.define(["jquery.sap.global","nrg/base/view/BaseController","nrg/base/type/Price","nrg/module/quickpay/view/QuickPayControl"],function(a,b,c,d){"use strict";var e=b.extend("nrg.module.billing.view.PrePayCheckbook");return e.prototype.onInit=function(){this.getOwnerComponent().getCcuxApp().setTitle("BILLING")},e.prototype.onBeforeRendering=function(){this.getView().setModel(this.getOwnerComponent().getModel("comp-billing"),"oDataSvc"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oPpChkbkHdr"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oPpPmtHdr"),this._initRoutingInfo(),this._initPpChkbookHdr(),this._initPpPmtHdr()},e.prototype._formatDate=function(a){var b;return a?b=(a.getMonth()+1).toString()+"/"+a.getDate().toString()+"/"+a.getFullYear().toString().substring(2,4):null},e.prototype._formatBoolCredit=function(a){return parseInt(a,10)>0?!0:!1},e.prototype._formatBoolDebit=function(a){return parseInt(a,10)<=0?!0:!1},e.prototype._onPpPmtHdrClicked=function(a){var b,c=this.getView().getModel("oPpPmtHdr");b=a.oSource.oBindingContexts.oPpPmtHdr.getPath(),c.getProperty(b+"/bExpand")&&this._retrPpPmtItmes(c.getProperty(b).ActKey,b)},e.prototype._onPaymentOptionsClick=function(){var a=new d;this.getView().addDependent(a),this._coNum&&a.openQuickPay(this._coNum,this.bpNum,this.caNum)},e.prototype._onHighBillFactorClick=function(){var a=this.getOwnerComponent().getRouter();this._coNum?a.navTo("billing.HighBill",{bpNum:this._bpNum,caNum:this._caNum,coNum:this._coNum}):a.navTo("billing.HighBillNoCo",{bpNum:this._bpNum,caNum:this._caNum})},e.prototype._onBackToDashboard=function(){var a=this.getOwnerComponent().getRouter();this._coNum?a.navTo("dashboard.VerificationWithCaCo",{bpNum:this._bpNum,caNum:this._caNum,coNum:this._coNum}):a.navTo("dashboard.VerificationWithCa",{bpNum:this._bpNum,caNum:this._caNum})},e.prototype._initRoutingInfo=function(){var a=this.getOwnerComponent().getCcuxRouteManager().getCurrentRouteInfo();this._bpNum=a.parameters.bpNum,this._caNum=a.parameters.caNum,this._coNum=a.parameters.coNum},e.prototype._initPpChkbookHdr=function(){var a;a="/PrePayHeaders(ContractAccountNumber='"+this._caNum+"',InvNumber='')",this._retrPpChkbookHdr(a)},e.prototype._initPpPmtHdr=function(){var a;a="/ConfBuags('"+this._caNum+"')/PrePayPmtHdrs",this._retrPpPmtHdr(a)},e.prototype._retrPpPmtItmes=function(a,b){var c,d,e=this.getView().getModel("oDataSvc");d="/PrePayPmtHdrs(ContractAccountNumber='"+this._caNum+"',ActKey='"+a+"')/PrePayPmtItems",c={success:function(a){a&&this.getView().getModel("oPpPmtHdr").setProperty(b+"/PpPmtItmes",a)}.bind(this),error:function(){}.bind(this)},e&&e.read(d,c)},e.prototype._retrPpChkbookHdr=function(a){var b,c=this.getView().getModel("oDataSvc");b={success:function(a){a&&this.getView().getModel("oPpChkbkHdr").setData(a)}.bind(this),error:function(){}.bind(this)},c&&c.read(a,b)},e.prototype._retrPpPmtHdr=function(a){var b,c,d=this.getView().getModel("oDataSvc");b={success:function(a){if(a){for(c=0;c<a.results.length;c+=1)c!==a.results.length-1?a.results[c].bExpand=!1:(a.results[c].bExpand=!0,this._retrPpPmtItmes(a.results[c].ActKey,"/results/"+c.toString()));this.getView().getModel("oPpPmtHdr").setData(a)}}.bind(this),error:function(){}.bind(this)},d&&d.read(a,b)},e});