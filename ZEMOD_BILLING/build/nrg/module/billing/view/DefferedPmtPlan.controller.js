sap.ui.define(["nrg/base/view/BaseController","jquery.sap.global","nrg/base/type/Price","sap/ui/core/routing/HashChanger","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(a,b,c,d,e,f,g){"use strict";var h=a.extend("nrg.module.billing.view.DefferedPmtPlan");return h.prototype.onInit=function(){},h.prototype.onBeforeRendering=function(){var a=this.getOwnerComponent().getCcuxContextManager().getContext().oData;this._bpNum=a.bpNum,this._caNum=a.caNum,this._coNum=a.coNum,this._isExt=a.isExt,this.getView().setModel(this.getOwnerComponent().getModel("comp-dppext"),"oDataSvc"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppScrnControl"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppEligible"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppDeniedReason"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppReasons"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppSetUps"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppStepOnePost"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppStepOneSelectedData"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppConfs"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppConfsChecked"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppStepTwoPost"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppStepTwoConfirmdData"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oDppStepThreeCom"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oExtEligible"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oExtExtensions"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oExtExtReasons"),this.getView().setModel(new sap.ui.model.json.JSONModel,"oExtPostRequest"),this._initScrnControl(),this._startScrnControl()},h.prototype.onAfterRendering=function(){this.getView().byId("nrgBilling-dpp-ExtNewDate-id").attachBrowserEvent("select",this._handleExtDateChange,this),this.getView().byId("nrgBilling-dpp-DppStartDate-id").attachBrowserEvent("select",this._handleDppStartDateChange,this),this.getView().byId("nrgBilling-dpp-DppDueDate-id").attachBrowserEvent("select",this._handleDppFirstDueDateChange,this)},h.prototype._initScrnControl=function(){var a=this.getView().getModel("oDppScrnControl");a.setProperty("/StepOne",!1),a.setProperty("/StepTwo",!1),a.setProperty("/StepThree",!1),a.setProperty("/DPPDenied",!1),a.setProperty("/EXTGrant",!1),a.setProperty("/EXTDenied",!1)},h.prototype._startScrnControl=function(){var a=(this.getView().getModel("oDppScrnControl"),new d),b=a.getHash(),c=b.split("/");"defferedpaymentplan"===c[1]?this._isDppElgble():"defferedpaymentext"===c[1]&&this._isExtElgble()},h.prototype._selectScrn=function(a){var b=this.getView().getModel("oDppScrnControl");if(b.setProperty("/StepOne",!1),b.setProperty("/StepTwo",!1),b.setProperty("/StepThree",!1),b.setProperty("/DPPDenied",!1),b.setProperty("/EXTGrant",!1),b.setProperty("/EXTDenied",!1),b.setProperty("/"+a,!0),"StepOne"===a)this._retrDppSetUp(),this._retrDppReason();else if("StepTwo"===a)this._retrDPPConf(),this._retrDisclosureMessage();else if("StepThree"===a)this._retrDppComunication();else if("DPPDenied"===a)this._retrDppDeniedReason();else if("EXTGrant"===a)this._retrExtReasons(),this._retrExtensions();else{if("EXTDenied"!==a)return;this._retrExtensions()}},h.prototype._postiveXFormatter=function(a){return"X"===a||"x"===a?!0:!1},h.prototype._negativeXFormatter=function(a){return"X"===a||"x"===a?!1:!0},h.prototype._reverseBooleanFormatter=function(a){return!a},h.prototype._formatShowChangeExt=function(a,b){return("X"===a||"x"===a)&&b?!0:!1},h.prototype._formatShowChangDwnPmt=function(a,b){return"X"===a||"x"===a?b?!1:!0:!1},h.prototype._isOdd=function(a){return a%2===0?!1:!0},h.prototype._isEven=function(a){return a%2===0?!0:!1},h.prototype._formatDate=function(a){var b;return a?b=(a.getMonth()+1).toString()+"/"+a.getDate().toString()+"/"+a.getFullYear().toString().substring(2,4):null},h.prototype._formatInvoiceDate=function(a,b,c){return 10>a&&(a="0"+a),10>b&&(b="0"+b),b+"/"+a+"/"+c},h.prototype._createSearchFilterObject=function(a,b,c){var d,e=[];if(c||(c=g.EQ),void 0!==a)for(d=0;d<a.length;d+=1)e.push(new f(a[d],g.EQ,b[d],""));return e},h.prototype._onComEmailCheck=function(){var a=this.getView().getModel("oDppStepThreeCom");a.setProperty("/eMailCheck",!0),a.setProperty("/FaxCheck",!1),a.setProperty("/AddrCheck",!1)},h.prototype._onComFaxCheck=function(){var a=this.getView().getModel("oDppStepThreeCom");a.setProperty("/eMailCheck",!1),a.setProperty("/FaxCheck",!0),a.setProperty("/AddrCheck",!1)},h.prototype._onComAddrCheck=function(){var a=this.getView().getModel("oDppStepThreeCom");a.setProperty("/eMailCheck",!1),a.setProperty("/FaxCheck",!1),a.setProperty("/AddrCheck",!0)},h.prototype._onDppDeniedOkClick=function(){var a=this.getOwnerComponent().getRouter();this._coNum?a.navTo("dashboard.VerificationWithCaCo",{bpNum:this._bpNum,caNum:this._caNum,coNum:this._coNum}):a.navTo("dashboard.VerificationWithCa",{bpNum:this._bpNum,caNum:this._caNum})},h.prototype._onDppOverrideClick=function(){this._selectScrn("StepOne")},h.prototype._onExtOverrideClick=function(){this._selectScrn("EXTGrant"),this._bOverRide=!0},h.prototype._onDppExtChangeClick=function(){var a=this.getView().getModel("oExtEligible");a.setProperty("/ExtActive",!1)},h.prototype._onDppExtConfirmClick=function(){this._postExtRequest()},h.prototype._onDPPThirdStepSend=function(){this._postDPPCommunication()},h.prototype._onReasonSelect=function(a){var b,c=this.getView().getModel("oDppReasons");for(b=0;b<c.oData.length;b+=1)c.oData[b].ReasonCode===a.mParameters.selectedKey&&c.setProperty("/selectedReason",c.oData[b].Reason)},h.prototype._onExtReasonSelect=function(a){this._extReason=a.mParameters.Reason},h.prototype._onSelectAllCheck=function(a){var b,c=this.getView().getModel("oDppSetUps");if(a.mParameters.checked)for(b=0;b<c.getData().results.length;b+=1)c.setProperty("/results/"+b+"/OpenItems/bSelected",!0);else for(b=0;b<c.getData().results.length;b+=1)c.setProperty("/results/"+b+"/OpenItems/bSelected",!1)},h.prototype._onDppConfAllCheck=function(a){var b,c=this.getView().getModel("oDppConfs");if(a.mParameters.checked)for(b=0;b<c.getData().results.length;b+=1)c.setProperty("/results/"+b+"/Checked",!0);else for(b=0;b<c.getData().results.length;b+=1)c.setProperty("/results/"+b+"/Checked",!1)},h.prototype._onStepTwoInstlChange=function(){var a,b=this.getView().getModel("oDppConfs"),c=0,d=0;for(a=0;a<b.getData().results.length;a+=1)c+=parseFloat(b.getProperty("/results/"+a+"/ConfirmdItems/Amount"));d=parseFloat(b.getProperty("/results/0/TotOutStd"))-c,b.setProperty("/results/0/DiffTot",d.toString()),b.setProperty("/results/0/DppTot",c.toString())},h.prototype._onDistributeDiffClick=function(){var a,b,c=this.getView().getModel("oDppConfs"),d=0;for(a=0;a<c.getData().results.length;a+=1)c.getProperty("/results/"+a+"/Checked")&&(d=parseFloat(d)+parseFloat(c.getProperty("/results/"+a+"/ConfirmdItems/Amount")),b=a+1);for(a=0;a<c.getData().results.length;a+=1)c.getProperty("/results/"+a+"/Checked")&&c.setProperty("/results/"+a+"/ConfirmdItems/Amount",parseFloat(d)/parseFloat(b));for(a=0;a<c.getData().results.length;a+=1)c.setProperty("/results/"+a+"/Checked",!1);c.setProperty("/AllChecked",!1)},h.prototype._onDppConfItemCheck=function(){var a,b=this.getView().getModel("oDppConfs"),c=0;for(a=0;a<b.getData().results.length;a+=1)b.getProperty("/results/"+a+"/Checked")&&(c=parseFloat(c)+parseFloat(b.getProperty("/results/"+a+"/ConfirmdItems/Amount")));b.setProperty("/results/0/SelTot",c.toString())},h.prototype._formatPadZero=function(a,b){for(;a.length<b;)a="0"+a;return a},h.prototype._onDppConfConfirmClick=function(){var a,b,c,d,e,f,g,h,i,j,k=this.getView().getModel("oDppConfs"),l=this.getView().getModel("oDppStepTwoPost"),m="",n="",o="",p="",q="",r="",s="",t="",u="",v="";for(l.setProperty("/ContractAccountNumber",k.oData.results[0].ContractAccountNumber),l.setProperty("/PartnerID",k.oData.results[0].PartnerID),l.setProperty("/SelectedData",k.oData.results[0].SelectedData.replace(/"/g,"'")),l.setProperty("/InstlmntNo",k.oData.results[0].InstlmntNo),l.setProperty("/ZeroDwnPay",k.oData.results[0].ZeroDwnPay),l.setProperty("/InitialDate",k.oData.results[0].InitialDate),l.setProperty("/ReasonCode",this.getView().getModel("oDppReasons").getProperty("/selectedKey")),l.setProperty("/Reason",this.getView().getModel("oDppReasons").setProperty("/selectedReason")),a=0;a<k.getData().results.length;a+=1)b=k.getData().results[a].ConfirmdItems.Amount?parseFloat(k.getData().results[a].ConfirmdItems.Amount).toString():"0.00",c=k.getData().results[a].ConfirmdItems.DueDate?k.getData().results[a].ConfirmdItems.DueDate.getFullYear().toString()+this._formatPadZero((k.getData().results[a].ConfirmdItems.DueDate.getMonth()+1).toString(),2)+this._formatPadZero(k.getData().results[a].ConfirmdItems.DueDate.getDate().toString(),2):"null",d=k.getData().results[a].ConfirmdItems.ClearDate?k.getData().results[a].ConfirmdItems.ClearDate.getFullYear().toString()+this._formatPadZero((k.getData().results[a].ConfirmdItems.ClearDate.getMonth()+1).toString(),2)+this._formatPadZero(k.getData().results[a].ConfirmdItems.ClearDate.getDate().toString(),2):"null",e=k.getData().results[a].ConfirmdItems.Cleared?k.getData().results[a].ConfirmdItems.Cleared:"null",f=k.getData().results[a].ConfirmdItems.ClearedAmt?parseFloat(k.getData().results[a].ConfirmdItems.ClearedAmt).toString():"0.00",g=k.getData().results[a].ConfirmdItems.Opbel?k.getData().results[a].ConfirmdItems.Opbel:"null",h=k.getData().results[a].ConfirmdItems.Opupw?parseInt(k.getData().results[a].ConfirmdItems.Opupw,10).toString():"0",i=k.getData().results[a].ConfirmdItems.Opupk?parseInt(k.getData().results[a].ConfirmdItems.Opupk,10).toString():"0",j=k.getData().results[a].ConfirmdItems.Opupz?parseInt(k.getData().results[a].ConfirmdItems.Opupz,10).toString():"0",a===k.getData().results.length-1?(m+=k.getData().results[a].ConfirmdItems.ItemNumber.toString(),n+=b,o+=c,p+=d,q+=e,r+=f,s+=g,t+=h,u+=i,v+=j):(m=m+k.getData().results[a].ConfirmdItems.ItemNumber.toString()+",",n=n+b+",",o=o+c+",",p=p+d+",",q=q+e+",",r=r+f+",",s=s+g+",",t=t+h+",",u=u+i+",",v=v+j+",");l.setProperty("/CItemNum",m),l.setProperty("/CAmt",n),l.setProperty("/CDueDate",o),l.setProperty("/CClearDate",p),l.setProperty("/CCleared",q),l.setProperty("/CClearedAmt",r),l.setProperty("/COpbel",s),l.setProperty("/COpupw",t),l.setProperty("/COpupk",u),l.setProperty("/COpupz",v),this._postDPPConfRequest()},h.prototype._onDppConfCancelClick=function(){var a=this.getOwnerComponent().getRouter();this._coNum?a.navTo("dashboard.VerificationWithCaCo",{bpNum:this._bpNum,caNum:this._caNum,coNum:this._coNum}):a.navTo("dashboard.VerificationWithCa",{bpNum:this._bpNum,caNum:this._caNum})},h.prototype._onOneItemCheck=function(a){a.mParameters.checked||this.getView().getModel("oDppSetUps").setProperty("/results/bSelectedAll",!1)},h.prototype._onDppSetUpOk=function(){var a,b=this.getView().getModel("oDppSetUps"),c=this.getView().getModel("oDppStepOnePost"),d=[],e=this.getView().getModel("oDppReasons");if(e.getProperty("/selectedReason")){for(c.setProperty("/InstlmntNo",b.getProperty("/results/0/InstlmntNo")),a=0;a<b.getData().results.length;a+=1)b.getProperty("/results/"+a+"/OpenItems/bSelected")&&d.push({IND:b.getProperty("/results/"+a+"/OpenItems/ItemNumber")});c.setProperty("/SelectedIndices",d),this.getView().getModel("oDppStepOneSelectedData").setProperty("/SELECTEDDATA",c.getProperty("/SelectedIndices")),this._selectScrn("StepTwo")}else ute.ui.main.Popup.Alert({title:"DPP REASON",message:"Please Select DPP Setup Reason"})},h.prototype._handleExtDateChange=function(){var a,b=new Date(this.getView().byId("nrgBilling-dpp-ExtNewDate-id").getValue()),c=this.getView().getModel("oExtExtensions");for(a=0;a<c.oData.results.length;a+=1)c.setProperty("/results/"+a+"/OpenItems/DefferalDate",b)},h.prototype._handleDppStartDateChange=function(){var a=new Date(this.getView().byId("nrgBilling-dpp-DppStartDate-id").getValue());this.getView().getModel("oDppSetUps").setProperty("/results/0/StartDate",a)},h.prototype._handleDppFirstDueDateChange=function(){var a=new Date(this.getView().byId("nrgBilling-dpp-DppDueDate-id").getValue());this.getView().getModel("oDppConfs").setProperty("/results/0/ConfirmdItems/DueDate",a)},h.prototype._postDPPCommunication=function(){var a,b,c=this.getView().getModel("oDataSvc"),d=this.getView().getModel("oDppStepThreeCom"),e=this.getOwnerComponent().getRouter();b="/DPPCorresps",a={merge:!1,success:function(){ute.ui.main.Popup.Alert({title:"DEFFERED PAYMENT PLAN",message:"Correspondence Successfully Sent."}),this._coNum?e.navTo("dashboard.VerificationWithCaCo",{bpNum:this._bpNum,caNum:this._caNum,coNum:this._coNum}):e.navTo("dashboard.VerificationWithCa",{bpNum:this._bpNum,caNum:this._caNum})}.bind(this),error:function(){ute.ui.main.Popup.Alert({title:"DEFFERED PAYMENT PLAN",message:"Correspondence Failed"})}.bind(this)},c&&c.create(b,d.oData,a)},h.prototype._retrDppComunication=function(){var a,b,c=this.getView().getModel("oDataSvc");b="/DPPCorresps(ContractAccountNumber='"+this._caNum+"',PartnerID='"+this._bpNum+"')",a={success:function(a){a&&(this.getView().getModel("oDppStepThreeCom").setData(a),this.getView().getModel("oDppStepThreeCom").setProperty("/eMailCheck",!0),this.getView().getModel("oDppStepThreeCom").setProperty("/FaxCheck",!1),this.getView().getModel("oDppStepThreeCom").setProperty("/AddrCheck",!1))}.bind(this),error:function(){}.bind(this)},c&&c.read(b,a)},h.prototype._retrDPPConf=function(){var a,b,c,d,e,f,g,h,i=this.getView().getModel("oDataSvc");h=h?this.getView().getModel("oDppSetUps").getProperty("/results/0/StartDate"):new Date,e=["ContractAccountNumber","SelectedData","InstlmntNo","ZeroDwnPay","InitialDate"],d=[this._caNum,this.getView().getModel("oDppStepOneSelectedData").getJSON(),this.getView().getModel("oDppStepOnePost").getProperty("/InstlmntNo"),this.getView().getModel("oDppStepOnePost").getProperty("/ZeroDwnPay"),h],c=this._createSearchFilterObject(e,d),b="/DPPConfs",a={filters:c,success:function(a){if(a){for(this.getView().getModel("oDppConfs").setData(a),f=0;f<a.results.length;f+=1)this.getView().getModel("oDppConfs").setProperty("/results/"+f+"/Checked",!1),this.getView().getModel("oDppConfs").setProperty("/results/"+f+"/ConfirmdItems/Amount",parseFloat(this.getView().getModel("oDppConfs").getProperty("/results/"+f+"/ConfirmdItems/Amount")));this.getView().getModel("oDppConfs").setProperty("/results/AllChecked",!1),this.getView().getModel("oDppConfs").setProperty("/results/0/SelTot",0),g=this._formatInvoiceDate(this.getView().getModel("oDppConfs").getProperty("/results/0/ConfirmdItems/DueDate").getDate(),this.getView().getModel("oDppConfs").getProperty("/results/0/ConfirmdItems/DueDate").getMonth()+1,this.getView().getModel("oDppConfs").getProperty("/results/0/ConfirmdItems/DueDate").getFullYear()),this.getView().byId("nrgBilling-dpp-DppDueDate-id").setDefaultDate(g)}}.bind(this),error:function(){}.bind(this)},i&&i.read(b,a)},h.prototype._retrDisclosureMessage=function(){var a,b,c=this.getView().getModel("oDataSvc");b="/DPPDisclos",a={success:function(a){a&&(this.sDisCloseMessage=a.results[0].Message)}.bind(this),error:function(){}.bind(this)},c&&c.read(b,a)},h.prototype._postDPPConfRequest=function(){var a,b,c=this.getView().getModel("oDataSvc"),d=this.getView().getModel("oDppStepTwoPost");a="/DPPConfs",b={merge:!1,success:function(){ute.ui.main.Popup.Alert({title:"DEFFERED PAYMENT PLAN",message:"DEFFERED PAYMENT PLAN request Success"}),this._selectScrn("StepThree")}.bind(this),error:function(){ute.ui.main.Popup.Alert({title:"DEFFERED PAYMENT PLAN",message:"DEFFERED PAYMENT PLAN request failed"}),this._selectScrn("StepThree")}.bind(this)},ute.ui.main.Popup.Confirm({title:"DISCLOSURE",message:this.sDisCloseMessage,callback:function(e){"Yes"===e&&c&&c.create(a,d.oData,b)}})},h.prototype._isDppElgble=function(){var a,b,c,d,e,f=this.getView().getModel("oDataSvc");e=["ContractAccountNumber"],d=[this._caNum],c=this._createSearchFilterObject(e,d),b="/DPPElgbles",a={filters:c,success:function(a){a.results[0]&&(this.getView().getModel("oDppEligible").setData(a.results[0]),this._selectScrn(a.results[0].EligibleYes?"StepOne":"DPPDenied"))}.bind(this),error:function(){}.bind(this)},f&&f.read(b,a)},h.prototype._isExtElgble=function(){var a,b,c,d,e,f=this.getView().getModel("oDataSvc");e=["ContractAccountNumber"],d=[this._caNum],c=this._createSearchFilterObject(e,d),b="/ExtElgbles",a={filters:c,success:function(a){a.results[0]&&(this.getView().getModel("oExtEligible").setData(a.results[0]),this._selectScrn(this.getView().getModel("oExtEligible").getProperty("/EligibleYes")?"EXTGrant":"EXTDenied"))}.bind(this),error:function(){}.bind(this)},f&&f.read(b,a)},h.prototype._retrDppDeniedReason=function(){var a,b,c,d,e,f,g=this.getView().getModel("oDataSvc");f=["ContractAccountNumber"],e=[this._caNum],d=this._createSearchFilterObject(f,e),b="/DPPDenieds",a={filters:d,success:function(a){if(a){for(c=0;c<a.results.length;c+=1)a.results[c].DPPDenyed.iIndex=c+1;this.getView().getModel("oDppDeniedReason").setData(a)}}.bind(this),error:function(){}.bind(this)},g&&g.read(b,a)},h.prototype._retrDppReason=function(){var a,b,c=this.getView().getModel("oDataSvc");b="/DPPReasons",a={success:function(a){a&&(a.results.push({ReasonCode:"0000",Reason:""}),this.getView().getModel("oDppReasons").setData(a.results),this.getView().getModel("oDppEligible").getProperty("/DPPReasonYes")?(this.getView().getModel("oDppReasons").setProperty("/selectedKey","0000"),this.getView().getModel("oDppReasons").setProperty("/selectedReason",this.getView().getModel("oDppEligible").getProperty("/DPPReason"))):(this.getView().getModel("oDppReasons").setProperty("/selectedKey","0000"),this.getView().getModel("oDppReasons").setProperty("/selectedReason","")))}.bind(this),error:function(){}.bind(this)},c&&c.read(b,a)},h.prototype._retrDppSetUp=function(){var a,b,c,d,e,f,g,h=this.getView().getModel("oDataSvc");this.getView().getModel("oDppStepOnePost").setData({}),g=["ContractAccountNumber"],f=[this._caNum],e=this._createSearchFilterObject(g,f),b="/DPPSetUps",a={filters:e,success:function(a){if(a){for(c=0;c<a.results.length;c+=1)a.results[c].bSelected=!1;this.getView().getModel("oDppSetUps").setData(a),this.getView().getModel("oDppSetUps").setProperty("/results/bSelectedAll",!1),this.getView().getModel("oDppStepOnePost").setProperty("/InstlmntNo",this.getView().getModel("oDppSetUps").getProperty("/results/0/InstlmntNo")),this.getView().getModel("oDppStepOnePost").setProperty("/ZeroDwnPay",""),d=this._formatInvoiceDate(this.getView().getModel("oDppSetUps").getProperty("/results/0/StartDate").getDate(),this.getView().getModel("oDppSetUps").getProperty("/results/0/StartDate").getMonth()+1,this.getView().getModel("oDppSetUps").getProperty("/results/0/StartDate").getFullYear()),this.getView().byId("nrgBilling-dpp-DppStartDate-id").setDefaultDate(d)}}.bind(this),error:function(){}.bind(this)},h&&h.read(b,a)},h.prototype._retrExtReasons=function(){var a,b,c=this.getView().getModel("oDataSvc");b="/ExtReasons",a={success:function(a){a&&(this.getView().getModel("oExtExtReasons").setData(a),this.getView().getModel("oExtExtReasons").setProperty("/selectedKey","2800"))}.bind(this),error:function(){}.bind(this)},c&&c.read(b,a)},h.prototype._retrExtensions=function(){var a,b,c,d,e,f,g=this.getView().getModel("oDataSvc");f=["ContractAccountNumber"],e=[this._caNum],d=this._createSearchFilterObject(f,e),b="/Extensions",a={filters:d,success:function(a){a&&(this.getView().getModel("oExtExtensions").setData(a),this.getView().getModel("oExtExtensions").setProperty("/results/0/iDwnPay",0),c=this._formatInvoiceDate(a.results[0].OpenItems.DefferalDate.getDate(),a.results[0].OpenItems.DefferalDate.getMonth()+1,a.results[0].OpenItems.DefferalDate.getFullYear()),this.getView().byId("nrgBilling-dpp-ExtNewDate-id").setDefaultDate(c))}.bind(this),error:function(){}.bind(this)},g&&g.read(b,a)},h.prototype._postExtRequest=function(){var a,b,c=this.getView().getModel("oDataSvc"),d=this.getView().getModel("oExtPostRequest"),e=this.getView().getModel("oExtExtensions"),f=(this.getView().getModel("oExtEligible"),this.getView().getModel("oExtExtReasons")),g=this.getView().byId("nrgBilling-dpp-dwnPayDueDate-id").getValue();d.setProperty("/ContractAccountNumber",this._caNum),d.setProperty("/PartnerID",e.getProperty("/results/0/PartnerID")),d.setProperty("/DefDtNew",e.getProperty("/results/0/OpenItems/DefferalDate")),d.setProperty("/DefDtOld",null),d.setProperty("/Message",""),d.setProperty("/Error",""),d.setProperty("/SelectedData",""),this._bOverRide?d.setProperty("/OverRide","X"):d.setProperty("/OverRide",""),d.setProperty("/DwnPay",e.getProperty("/results/0/iDwnPay")),g?d.setProperty("/DwnPayDate",new Date(g)):d.setProperty("/DwnPayDate",null),d.setProperty("/ExtReason",f.getProperty()),d.setProperty("/ExtReason",this._extReason),d.setProperty("/ExtActive",!1),d.setProperty("/ChgOpt",!1),a="/ExtConfs",b={merge:!1,success:function(){ute.ui.main.Popup.Alert({title:"Extension",message:"Extension request success"}),this._selectScrn("EXTGrant")}.bind(this),error:function(){ute.ui.main.Popup.Alert({title:"Extension",message:"Extension request failed"})}.bind(this)},c&&c.create(a,d.oData,b)},h});